# üìÑ –°–∏—Å—Ç–µ–º–∞ –ø–∞–≥–∏–Ω–∞—Ü–∏–∏ –∫–∞—Ç–∞–ª–æ–≥–∞

_[‚Üê –ù–∞–∑–∞–¥ –∫ –§–∏–ª—å—Ç—Ä–∞–º](12_CATALOG_FILTERS.md) | [–ö —Å–ø–∏—Å–∫—É —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤ ‚Üí](../GUIDES/)_

---

## üìã –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ

1. [–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ø–∞–≥–∏–Ω–∞—Ü–∏–∏](#–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞-–ø–∞–≥–∏–Ω–∞—Ü–∏–∏)
2. [–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å—Ç—Ä–∞–Ω–∏—Ü–∞–º–∏](#—É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ-—Å—Ç—Ä–∞–Ω–∏—Ü–∞–º–∏)
3. [–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å](#–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å)
4. [–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å —Ñ–∏–ª—å—Ç—Ä–∞–º–∏](#–∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è-—Å-—Ñ–∏–ª—å—Ç—Ä–∞–º–∏)
5. [–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —ç–ª–µ–º–µ–Ω—Ç–æ–≤](#–Ω–∞—Å—Ç—Ä–æ–π–∫–∞-–∫–æ–ª–∏—á–µ—Å—Ç–≤–∞-—ç–ª–µ–º–µ–Ω—Ç–æ–≤)
6. [–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∏ UX](#–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å-–∏-ux)

---

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ø–∞–≥–∏–Ω–∞—Ü–∏–∏

### –ü—Ä–∏–Ω—Ü–∏–ø—ã —Ä–∞–±–æ—Ç—ã

–°–∏—Å—Ç–µ–º–∞ –ø–∞–≥–∏–Ω–∞—Ü–∏–∏ –ø–æ—Å—Ç—Ä–æ–µ–Ω–∞ –Ω–∞ —Å–ª–µ–¥—É—é—â–∏—Ö –ø—Ä–∏–Ω—Ü–∏–ø–∞—Ö:

1. **–°–µ—Ä–≤–µ—Ä–Ω–∞—è –ø–∞–≥–∏–Ω–∞—Ü–∏—è** - –¥–∞–Ω–Ω—ã–µ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –ø–æ—Ä—Ü–∏—è–º–∏ —Å —Å–µ—Ä–≤–µ—Ä–∞
2. **–ì–∏–±–∫–æ—Å—Ç—å –Ω–∞—Å—Ç—Ä–æ–µ–∫** - –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç –≤—ã–±–∏—Ä–∞—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —ç–ª–µ–º–µ–Ω—Ç–æ–≤
3. **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å —Ñ–∏–ª—å—Ç—Ä–∞–º–∏** - –ø–∞–≥–∏–Ω–∞—Ü–∏—è —Å–±—Ä–∞—Å—ã–≤–∞–µ—Ç—Å—è –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ —Ñ–∏–ª—å—Ç—Ä–æ–≤
4. **–ü–ª–∞–≤–Ω—ã–µ –ø–µ—Ä–µ—Ö–æ–¥—ã** - –∞–Ω–∏–º–∞—Ü–∏–∏ –∏ –ø—Ä–æ–∫—Ä—É—Ç–∫–∞ –¥–ª—è –ª—É—á—à–µ–≥–æ UX

### –°–æ—Å—Ç–æ—è–Ω–∏–µ –ø–∞–≥–∏–Ω–∞—Ü–∏–∏

```javascript
/**
 * Pagination state in global state object
 */
const paginationState = {
  // –¢–µ–∫—É—â–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ (1-indexed)
  currentPage: 1,

  // –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ
  itemsPerPage: 16,

  // –û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å—Ç—Ä–∞–Ω–∏—Ü
  totalPages: 1,

  // –û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —ç–ª–µ–º–µ–Ω—Ç–æ–≤
  totalItems: 0,

  // –î–æ—Å—Ç—É–ø–Ω—ã–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ
  availablePageSizes: [8, 12, 16, 24, 32, 48],

  // –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤–∏–¥–∏–º—ã—Ö –∫–Ω–æ–ø–æ–∫ —Å—Ç—Ä–∞–Ω–∏—Ü
  maxVisiblePages: 7,

  // –ö–∞—Å—Ç–æ–º–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ (–µ—Å–ª–∏ –≤—ã–±—Ä–∞–Ω–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º)
  customPageSize: null,
};
```

---

## üéõÔ∏è –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å—Ç—Ä–∞–Ω–∏—Ü–∞–º–∏

### –û—Å–Ω–æ–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –Ω–∞–≤–∏–≥–∞—Ü–∏–∏

```javascript
/**
 * Navigate to specific page
 */
function goToPage(pageNumber) {
  // –í–∞–ª–∏–¥–∞—Ü–∏—è —Å—Ç—Ä–∞–Ω–∏—Ü—ã
  if (!isValidPage(pageNumber)) {
    console.warn("Invalid page number:", pageNumber);
    return;
  }

  console.log(`Navigating to page ${pageNumber}`);

  // –û–±–Ω–æ–≤–ª—è–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ
  state.currentPage = pageNumber;

  // –ó–∞–≥—Ä—É–∂–∞–µ–º –¥–∞–Ω–Ω—ã–µ
  loadBooks();

  // –û–±–Ω–æ–≤–ª—è–µ–º URL
  updatePageURL(pageNumber);

  // –ü—Ä–æ–∫—Ä—É—á–∏–≤–∞–µ–º –∫ –Ω–∞—á–∞–ª—É –∫–∞—Ç–∞–ª–æ–≥–∞
  scrollToCatalogTop();

  // –ê–Ω–∞–ª–∏—Ç–∏–∫–∞
  trackPageNavigation(pageNumber);
}

/**
 * Go to next page
 */
function goToNextPage() {
  if (state.currentPage < state.totalPages) {
    goToPage(state.currentPage + 1);
  }
}

/**
 * Go to previous page
 */
function goToPreviousPage() {
  if (state.currentPage > 1) {
    goToPage(state.currentPage - 1);
  }
}

/**
 * Go to first page
 */
function goToFirstPage() {
  if (state.currentPage !== 1) {
    goToPage(1);
  }
}

/**
 * Go to last page
 */
function goToLastPage() {
  if (state.currentPage !== state.totalPages) {
    goToPage(state.totalPages);
  }
}

/**
 * Validate page number
 */
function isValidPage(pageNumber) {
  return (
    Number.isInteger(pageNumber) &&
    pageNumber >= 1 &&
    pageNumber <= state.totalPages
  );
}

/**
 * Reset to first page (used when filters change)
 */
function resetToFirstPage() {
  state.currentPage = 1;
}
```

### –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ URL

```javascript
/**
 * Update URL with current page
 */
function updatePageURL(pageNumber) {
  const url = new URL(window.location);

  if (pageNumber === 1) {
    // –£–¥–∞–ª—è–µ–º –ø–∞—Ä–∞–º–µ—Ç—Ä page –¥–ª—è –ø–µ—Ä–≤–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã
    url.searchParams.delete("page");
  } else {
    url.searchParams.set("page", pageNumber);
  }

  // –û–±–Ω–æ–≤–ª—è–µ–º URL –±–µ–∑ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏
  window.history.replaceState({}, "", url);
}

/**
 * Load page from URL
 */
function loadPageFromURL() {
  const params = new URLSearchParams(window.location.search);
  const pageParam = params.get("page");

  if (pageParam) {
    const pageNumber = parseInt(pageParam);

    if (isValidPage(pageNumber)) {
      state.currentPage = pageNumber;
      return true;
    } else {
      console.warn("Invalid page in URL, redirecting to page 1");
      updatePageURL(1);
    }
  }

  return false;
}
```

### –ü—Ä–æ–∫—Ä—É—Ç–∫–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—ã

```javascript
/**
 * Scroll to catalog top with smooth animation
 */
function scrollToCatalogTop() {
  const catalogElement = elements.booksContainer;
  if (!catalogElement) return;

  const offsetTop = catalogElement.offsetTop - 100; // –û—Ç—Å—Ç—É–ø –æ—Ç –≤–µ—Ä—Ö–∞

  window.scrollTo({
    top: offsetTop,
    behavior: "smooth",
  });
}

/**
 * Scroll to pagination controls
 */
function scrollToPagination() {
  const paginationElement = elements.paginationContainer;
  if (!paginationElement) return;

  paginationElement.scrollIntoView({
    behavior: "smooth",
    block: "center",
  });
}
```

---

## üé® –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å

### –†–µ–Ω–¥–µ—Ä–∏–Ω–≥ –ø–∞–≥–∏–Ω–∞—Ü–∏–∏

```javascript
/**
 * Render pagination controls
 */
function renderPagination() {
  if (!elements.paginationContainer) return;

  // –ï—Å–ª–∏ —Ç–æ–ª—å–∫–æ –æ–¥–Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–∞, —Å–∫—Ä—ã–≤–∞–µ–º –ø–∞–≥–∏–Ω–∞—Ü–∏—é
  if (state.totalPages <= 1) {
    elements.paginationContainer.innerHTML = "";
    return;
  }

  const pagination = createPaginationHTML();
  elements.paginationContainer.innerHTML = pagination;

  // –î–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π
  addPaginationEventListeners();

  console.log(`Rendered pagination for ${state.totalPages} pages`);
}

/**
 * Create pagination HTML
 */
function createPaginationHTML() {
  const pages = generatePageNumbers();

  return `
        <div class="pagination-wrapper">
            <div class="pagination-info">
                ${createPaginationInfo()}
            </div>
            <div class="pagination-controls">
                ${createNavigationButtons()}
                ${createPageButtons(pages)}
                ${createNavigationButtons(false)}
            </div>
            <div class="pagination-jump">
                ${createPageJumpInput()}
            </div>
        </div>
    `;
}

/**
 * Create pagination info text
 */
function createPaginationInfo() {
  const startItem = (state.currentPage - 1) * state.itemsPerPage + 1;
  const endItem = Math.min(
    state.currentPage * state.itemsPerPage,
    state.totalItems
  );

  return `
        <span class="pagination-text">
            –ü–æ–∫–∞–∑–∞–Ω–æ ${startItem}-${endItem} –∏–∑ ${state.totalItems} –∫–Ω–∏–≥
        </span>
    `;
}

/**
 * Create navigation buttons (prev/next, first/last)
 */
function createNavigationButtons(isLeft = true) {
  if (isLeft) {
    return `
            <button 
                class="pagination-btn pagination-btn-nav" 
                data-action="first"
                ${state.currentPage === 1 ? "disabled" : ""}
                title="–ü–µ—Ä–≤–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞"
            >
                ‚èÆÔ∏è
            </button>
            <button 
                class="pagination-btn pagination-btn-nav" 
                data-action="prev"
                ${state.currentPage === 1 ? "disabled" : ""}
                title="–ü—Ä–µ–¥—ã–¥—É—â–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞"
            >
                ‚óÄÔ∏è
            </button>
        `;
  } else {
    return `
            <button 
                class="pagination-btn pagination-btn-nav" 
                data-action="next"
                ${state.currentPage === state.totalPages ? "disabled" : ""}
                title="–°–ª–µ–¥—É—é—â–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞"
            >
                ‚ñ∂Ô∏è
            </button>
            <button 
                class="pagination-btn pagination-btn-nav" 
                data-action="last"
                ${state.currentPage === state.totalPages ? "disabled" : ""}
                title="–ü–æ—Å–ª–µ–¥–Ω—è—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞"
            >
                ‚è≠Ô∏è
            </button>
        `;
  }
}

/**
 * Create page number buttons
 */
function createPageButtons(pages) {
  return pages
    .map((page) => {
      if (page === "...") {
        return `<span class="pagination-ellipsis">...</span>`;
      }

      const isActive = page === state.currentPage;

      return `
            <button 
                class="pagination-btn pagination-btn-page ${
                  isActive ? "active" : ""
                }"
                data-page="${page}"
                ${isActive ? "disabled" : ""}
            >
                ${page}
            </button>
        `;
    })
    .join("");
}

/**
 * Create page jump input
 */
function createPageJumpInput() {
  return `
        <div class="page-jump">
            <label for="page-jump-input">–ü–µ—Ä–µ–π—Ç–∏ –∫ —Å—Ç—Ä–∞–Ω–∏—Ü–µ:</label>
            <input 
                type="number" 
                id="page-jump-input" 
                class="page-jump-input"
                min="1" 
                max="${state.totalPages}"
                value="${state.currentPage}"
                placeholder="‚Ññ"
            >
            <button class="btn btn-small" onclick="jumpToPage()">
                –ü–µ—Ä–µ–π—Ç–∏
            </button>
        </div>
    `;
}
```

### –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –Ω–æ–º–µ—Ä–æ–≤ —Å—Ç—Ä–∞–Ω–∏—Ü

```javascript
/**
 * Generate page numbers for pagination display
 */
function generatePageNumbers() {
  const maxVisible = state.maxVisiblePages;
  const current = state.currentPage;
  const total = state.totalPages;

  // –ï—Å–ª–∏ —Å—Ç—Ä–∞–Ω–∏—Ü –º–µ–Ω—å—à–µ –º–∞–∫—Å–∏–º—É–º–∞, –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –≤—Å–µ
  if (total <= maxVisible) {
    return Array.from({ length: total }, (_, i) => i + 1);
  }

  const pages = [];
  const sidePages = Math.floor((maxVisible - 3) / 2); // -3 –¥–ª—è –ø–µ—Ä–≤–æ–π, –ø–æ—Å–ª–µ–¥–Ω–µ–π –∏ —Ç–µ–∫—É—â–µ–π

  // –í—Å–µ–≥–¥–∞ –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –ø–µ—Ä–≤—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É
  pages.push(1);

  // –û–ø—Ä–µ–¥–µ–ª—è–µ–º –¥–∏–∞–ø–∞–∑–æ–Ω –≤–æ–∫—Ä—É–≥ —Ç–µ–∫—É—â–µ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã
  let startPage = Math.max(2, current - sidePages);
  let endPage = Math.min(total - 1, current + sidePages);

  // –ö–æ—Ä—Ä–µ–∫—Ç–∏—Ä—É–µ–º –¥–∏–∞–ø–∞–∑–æ–Ω –µ—Å–ª–∏ –æ–Ω —Å–ª–∏—à–∫–æ–º –º–∞–ª
  if (endPage - startPage < maxVisible - 3) {
    if (current < total / 2) {
      endPage = Math.min(total - 1, startPage + maxVisible - 3);
    } else {
      startPage = Math.max(2, endPage - maxVisible + 3);
    }
  }

  // –î–æ–±–∞–≤–ª—è–µ–º –º–Ω–æ–≥–æ—Ç–æ—á–∏–µ –µ—Å–ª–∏ –Ω—É–∂–Ω–æ
  if (startPage > 2) {
    pages.push("...");
  }

  // –î–æ–±–∞–≤–ª—è–µ–º —Å—Ç—Ä–∞–Ω–∏—Ü—ã –≤ –¥–∏–∞–ø–∞–∑–æ–Ω–µ
  for (let i = startPage; i <= endPage; i++) {
    pages.push(i);
  }

  // –î–æ–±–∞–≤–ª—è–µ–º –º–Ω–æ–≥–æ—Ç–æ—á–∏–µ –µ—Å–ª–∏ –Ω—É–∂–Ω–æ
  if (endPage < total - 1) {
    pages.push("...");
  }

  // –í—Å–µ–≥–¥–∞ –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –ø–æ—Å–ª–µ–¥–Ω—é—é —Å—Ç—Ä–∞–Ω–∏—Ü—É (–µ—Å–ª–∏ –æ–Ω–∞ –Ω–µ –ø–µ—Ä–≤–∞—è)
  if (total > 1) {
    pages.push(total);
  }

  return pages;
}
```

### –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π

```javascript
/**
 * Add event listeners to pagination elements
 */
function addPaginationEventListeners() {
  const paginationContainer = elements.paginationContainer;
  if (!paginationContainer) return;

  // –î–µ–ª–µ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ–±—ã—Ç–∏–π –¥–ª—è –∫–Ω–æ–ø–æ–∫
  paginationContainer.addEventListener("click", (e) => {
    const button = e.target.closest(".pagination-btn");
    if (!button || button.disabled) return;

    const action = button.dataset.action;
    const page = button.dataset.page;

    if (action) {
      handleNavigationAction(action);
    } else if (page) {
      goToPage(parseInt(page));
    }
  });

  // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è –ø–æ–ª—è –≤–≤–æ–¥–∞ –Ω–æ–º–µ—Ä–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
  const jumpInput = paginationContainer.querySelector("#page-jump-input");
  if (jumpInput) {
    jumpInput.addEventListener("keypress", (e) => {
      if (e.key === "Enter") {
        jumpToPage();
      }
    });

    // –í–∞–ª–∏–¥–∞—Ü–∏—è –≤–≤–æ–¥–∞
    jumpInput.addEventListener("input", validatePageJumpInput);
  }
}

/**
 * Handle navigation action (first, prev, next, last)
 */
function handleNavigationAction(action) {
  switch (action) {
    case "first":
      goToFirstPage();
      break;
    case "prev":
      goToPreviousPage();
      break;
    case "next":
      goToNextPage();
      break;
    case "last":
      goToLastPage();
      break;
  }
}

/**
 * Jump to specific page from input
 */
window.jumpToPage = function () {
  const input = document.getElementById("page-jump-input");
  if (!input) return;

  const pageNumber = parseInt(input.value);

  if (isValidPage(pageNumber)) {
    goToPage(pageNumber);
  } else {
    showNotification("–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–≤–µ–¥–∏—Ç–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π –Ω–æ–º–µ—Ä —Å—Ç—Ä–∞–Ω–∏—Ü—ã", "error");
    input.focus();
    input.select();
  }
};

/**
 * Validate page jump input
 */
function validatePageJumpInput(e) {
  const value = parseInt(e.target.value);
  const isValid = isValidPage(value);

  e.target.style.borderColor = isValid ? "" : "#e74c3c";
}
```

---

## üîó –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å —Ñ–∏–ª—å—Ç—Ä–∞–º–∏

### –°–±—Ä–æ—Å –ø–∞–≥–∏–Ω–∞—Ü–∏–∏ –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ —Ñ–∏–ª—å—Ç—Ä–æ–≤

```javascript
/**
 * Reset pagination when filters change
 */
function onFiltersChanged() {
  console.log("Filters changed, resetting pagination...");

  // –°–±—Ä–∞—Å—ã–≤–∞–µ–º –Ω–∞ –ø–µ—Ä–≤—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É
  resetToFirstPage();

  // –û–±–Ω–æ–≤–ª—è–µ–º URL
  updatePageURL(1);

  // –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞–µ–º –¥–∞–Ω–Ω—ã–µ
  if (state.infiniteScrollMode) {
    resetInfiniteScrollState();
    loadBooksInfiniteScroll();
  } else {
    loadBooks();
  }
}

/**
 * Update pagination info when data changes
 */
function updatePaginationInfo(apiResponse) {
  if (apiResponse.data && apiResponse.data.pagination) {
    const pagination = apiResponse.data.pagination;

    state.totalPages = pagination.totalPages;
    state.totalItems = pagination.totalItems;
    state.currentPage = pagination.currentPage;

    console.log("Pagination info updated:", {
      currentPage: state.currentPage,
      totalPages: state.totalPages,
      totalItems: state.totalItems,
    });
  }
}
```

### –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è –ø–∞–≥–∏–Ω–∞—Ü–∏–∏

```javascript
/**
 * Save pagination state to sessionStorage
 */
function savePaginationState() {
  const paginationData = {
    currentPage: state.currentPage,
    itemsPerPage: state.itemsPerPage,
    customPageSize: state.customPageSize,
    timestamp: Date.now(),
  };

  try {
    sessionStorage.setItem("catalogPagination", JSON.stringify(paginationData));
  } catch (error) {
    console.warn("Could not save pagination state:", error);
  }
}

/**
 * Load pagination state from sessionStorage
 */
function loadPaginationState() {
  try {
    const saved = sessionStorage.getItem("catalogPagination");
    if (!saved) return false;

    const paginationData = JSON.parse(saved);
    const age = Date.now() - paginationData.timestamp;

    // –ò—Å–ø–æ–ª—å–∑—É–µ–º —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –æ–Ω–æ –Ω–µ —Å—Ç–∞—Ä—à–µ 30 –º–∏–Ω—É—Ç
    if (age < 30 * 60 * 1000) {
      state.currentPage = paginationData.currentPage;
      state.itemsPerPage = paginationData.itemsPerPage;
      state.customPageSize = paginationData.customPageSize;
      return true;
    }
  } catch (error) {
    console.warn("Could not load pagination state:", error);
  }

  return false;
}
```

---

## ‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —ç–ª–µ–º–µ–Ω—Ç–æ–≤

### –í—ã–±–æ—Ä –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ

```javascript
/**
 * Handle items per page change
 */
function handleItemsPerPageChange(newValue) {
  console.log("Items per page changed to:", newValue);

  if (newValue === "all") {
    // –ü–µ—Ä–µ–∫–ª—é—á–∞–µ–º—Å—è –≤ —Ä–µ–∂–∏–º infinite scroll
    enableInfiniteScrollMode();
    return;
  }

  if (newValue === "custom") {
    // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø–æ–ª–µ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–≥–æ –≤–≤–æ–¥–∞
    showCustomItemsInput();
    return;
  }

  // –û–±—ã—á–Ω–æ–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞
  const itemsCount = parseInt(newValue);

  if (itemsCount && itemsCount > 0) {
    changeItemsPerPage(itemsCount);
  }
}

/**
 * Change items per page count
 */
function changeItemsPerPage(newCount) {
  const oldItemsPerPage = state.itemsPerPage;

  // –í—ã—á–∏—Å–ª—è–µ–º –Ω–æ–≤—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É —á—Ç–æ–±—ã –ø–æ–∫–∞–∑–∞—Ç—å –ø—Ä–∏–º–µ—Ä–Ω–æ —Ç–µ –∂–µ –∫–Ω–∏–≥–∏
  const firstItemIndex = (state.currentPage - 1) * oldItemsPerPage;
  const newPage = Math.floor(firstItemIndex / newCount) + 1;

  // –û–±–Ω–æ–≤–ª—è–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ
  state.itemsPerPage = newCount;
  state.currentPage = newPage;

  // –û—Ç–∫–ª—é—á–∞–µ–º infinite scroll –µ—Å–ª–∏ –±—ã–ª –≤–∫–ª—é—á–µ–Ω
  if (state.infiniteScrollMode) {
    disableInfiniteScrollMode();
  }

  // –°–æ—Ö—Ä–∞–Ω—è–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ
  savePaginationState();

  // –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞–µ–º –¥–∞–Ω–Ω—ã–µ
  loadBooks();

  // –ê–Ω–∞–ª–∏—Ç–∏–∫–∞
  trackEvent("items_per_page_changed", {
    old_count: oldItemsPerPage,
    new_count: newCount,
    new_page: newPage,
  });
}

/**
 * Show custom items input
 */
function showCustomItemsInput() {
  toggleCustomInput(true);

  const input = elements.customItemsInput;
  if (input) {
    input.focus();
    input.value = state.itemsPerPage.toString();
    input.select();
  }
}

/**
 * Apply custom items count
 */
function applyCustomItemsCount() {
  const input = elements.customItemsInput;
  if (!input) return;

  const customValue = parseInt(input.value);

  if (isValidCustomItemsCount(customValue)) {
    changeItemsPerPage(customValue);

    // –î–æ–±–∞–≤–ª—è–µ–º –≤ —Å–µ–ª–µ–∫—Ç–æ—Ä –∫–∞–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫—É—é –æ–ø—Ü–∏—é
    addCustomOptionToSelector(customValue);

    // –°–∫—Ä—ã–≤–∞–µ–º –ø–æ–ª–µ –≤–≤–æ–¥–∞
    toggleCustomInput(false);

    showNotification(`–ü–æ–∫–∞–∑ –ø–æ ${customValue} –∫–Ω–∏–≥ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ`, "success");
  } else {
    showNotification("–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–≤–µ–¥–∏—Ç–µ —á–∏—Å–ª–æ –æ—Ç 1 –¥–æ 1000", "error");
    input.focus();
    input.select();
  }
}

/**
 * Validate custom items count
 */
function isValidCustomItemsCount(value) {
  return Number.isInteger(value) && value >= 1 && value <= 1000;
}

/**
 * Add custom option to items per page selector
 */
function addCustomOptionToSelector(value) {
  const select = elements.itemsPerPageSelect;
  if (!select) return;

  // –£–¥–∞–ª—è–µ–º —Å—Ç–∞—Ä—É—é –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫—É—é –æ–ø—Ü–∏—é
  const oldCustom = select.querySelector('option[data-custom="true"]');
  if (oldCustom) {
    oldCustom.remove();
  }

  // –°–æ–∑–¥–∞–µ–º –Ω–æ–≤—É—é –æ–ø—Ü–∏—é
  const option = document.createElement("option");
  option.value = value;
  option.textContent = value;
  option.selected = true;
  option.setAttribute("data-custom", "true");

  // –ù–∞—Ö–æ–¥–∏–º –ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ –º–µ—Å—Ç–æ –¥–ª—è –≤—Å—Ç–∞–≤–∫–∏
  const allOption = select.querySelector('option[value="all"]');
  if (allOption) {
    select.insertBefore(option, allOption);
  } else {
    select.appendChild(option);
  }
}
```

### –£–º–Ω—ã–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è

```javascript
/**
 * Suggest optimal page size based on screen and content
 */
function suggestOptimalPageSize() {
  const screenWidth = window.innerWidth;
  const screenHeight = window.innerHeight;

  // –ë–∞–∑–æ–≤—ã–µ —Ä–∞–∑–º–µ—Ä—ã –∫–∞—Ä—Ç–æ—á–∫–∏
  const cardWidth = 280;
  const cardHeight = 400;

  // –í—ã—á–∏—Å–ª—è–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–æ–ª–æ–Ω–æ–∫
  const columns = Math.floor(screenWidth / cardWidth);

  // –í—ã—á–∏—Å–ª—è–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å—Ç—Ä–æ–∫ –Ω–∞ —ç–∫—Ä–∞–Ω–µ
  const availableHeight = screenHeight - 300; // –£—á–∏—Ç—ã–≤–∞–µ–º header, filters, pagination
  const rows = Math.floor(availableHeight / cardHeight);

  // –ü—Ä–µ–¥–ª–∞–≥–∞–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ä–∞–≤–Ω–æ–µ 2-3 —ç–∫—Ä–∞–Ω–∞–º
  const suggested = Math.max(8, columns * rows * 2);

  // –û–∫—Ä—É–≥–ª—è–µ–º –¥–æ –±–ª–∏–∂–∞–π—à–µ–≥–æ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è
  const standardSizes = [8, 12, 16, 24, 32, 48];
  const closest = standardSizes.reduce((prev, curr) =>
    Math.abs(curr - suggested) < Math.abs(prev - suggested) ? curr : prev
  );

  console.log("Suggested page size:", {
    screenSize: { width: screenWidth, height: screenHeight },
    calculated: suggested,
    suggested: closest,
  });

  return closest;
}

/**
 * Auto-adjust page size for mobile
 */
function autoAdjustForMobile() {
  if (window.innerWidth <= 768 && state.itemsPerPage > 16) {
    console.log("Auto-adjusting page size for mobile");
    changeItemsPerPage(12);
    showNotification(
      "–†–∞–∑–º–µ—Ä —Å—Ç—Ä–∞–Ω–∏—Ü—ã –∞–¥–∞–ø—Ç–∏—Ä–æ–≤–∞–Ω –¥–ª—è –º–æ–±–∏–ª—å–Ω–æ–≥–æ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞",
      "info"
    );
  }
}

// –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫—É—é –∞–¥–∞–ø—Ç–∞—Ü–∏—é
const debouncedAutoAdjust = debounce(autoAdjustForMobile, 500);
window.addEventListener("resize", debouncedAutoAdjust);
```

---

## ‚ö° –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∏ UX

### –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Å—Ç—Ä–∞–Ω–∏—Ü

```javascript
/**
 * Page cache for better performance
 */
const pageCache = {
  cache: new Map(),
  maxSize: 10,

  /**
   * Generate cache key
   */
  generateKey(page, itemsPerPage, filters) {
    return JSON.stringify({
      page,
      itemsPerPage,
      filters: filterState.getActiveFilters(),
    });
  },

  /**
   * Get cached data
   */
  get(page, itemsPerPage, filters) {
    const key = this.generateKey(page, itemsPerPage, filters);
    const cached = this.cache.get(key);

    if (cached) {
      const age = Date.now() - cached.timestamp;

      // –ö—ç—à –≤–∞–ª–∏–¥–µ–Ω 5 –º–∏–Ω—É—Ç
      if (age < 5 * 60 * 1000) {
        console.log("Using cached page data");
        return cached.data;
      } else {
        this.cache.delete(key);
      }
    }

    return null;
  },

  /**
   * Cache page data
   */
  set(page, itemsPerPage, filters, data) {
    const key = this.generateKey(page, itemsPerPage, filters);

    this.cache.set(key, {
      data: data,
      timestamp: Date.now(),
    });

    // –û–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ–º —Ä–∞–∑–º–µ—Ä –∫—ç—à–∞
    if (this.cache.size > this.maxSize) {
      const firstKey = this.cache.keys().next().value;
      this.cache.delete(firstKey);
    }
  },

  /**
   * Clear cache
   */
  clear() {
    this.cache.clear();
  },
};
```

### –ü—Ä–µ–¥–∑–∞–≥—Ä—É–∑–∫–∞ —Å–æ—Å–µ–¥–Ω–∏—Ö —Å—Ç—Ä–∞–Ω–∏—Ü

```javascript
/**
 * Preload adjacent pages for faster navigation
 */
function preloadAdjacentPages() {
  if (state.infiniteScrollMode) return;

  const toPreload = [];

  // –ü—Ä–µ–¥–∑–∞–≥—Ä—É–∂–∞–µ–º —Å–ª–µ–¥—É—é—â—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É
  if (state.currentPage < state.totalPages) {
    toPreload.push(state.currentPage + 1);
  }

  // –ü—Ä–µ–¥–∑–∞–≥—Ä—É–∂–∞–µ–º –ø—Ä–µ–¥—ã–¥—É—â—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É
  if (state.currentPage > 1) {
    toPreload.push(state.currentPage - 1);
  }

  toPreload.forEach((page) => {
    setTimeout(() => preloadPage(page), 1000);
  });
}

/**
 * Preload specific page
 */
async function preloadPage(page) {
  try {
    // –ü—Ä–æ–≤–µ—Ä—è–µ–º –∫—ç—à
    const cached = pageCache.get(page, state.itemsPerPage, state.filters);
    if (cached) return;

    console.log("Preloading page:", page);

    const params = new URLSearchParams({
      page: page,
      limit: state.itemsPerPage,
      sortBy: "popularity",
      sortOrder: "DESC",
    });

    // –î–æ–±–∞–≤–ª—è–µ–º —Ñ–∏–ª—å—Ç—Ä—ã
    const apiFilters = filterState.getAPIFilters();
    Object.entries(apiFilters).forEach(([key, value]) => {
      params.append(key, value);
    });

    const response = await fetch(`/api/books?${params}`);

    if (response.ok) {
      const data = await response.json();

      if (data.success) {
        // –ö—ç—à–∏—Ä—É–µ–º –¥–∞–Ω–Ω—ã–µ
        pageCache.set(page, state.itemsPerPage, state.filters, data);
        console.log("Page preloaded successfully:", page);
      }
    }
  } catch (error) {
    console.warn("Failed to preload page:", page, error);
  }
}
```

### –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥–∞

```javascript
/**
 * Optimized pagination rendering with virtual scrolling for large page counts
 */
function renderPaginationOptimized() {
  if (!elements.paginationContainer) return;

  // –î–ª—è –±–æ–ª—å—à–æ–≥–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —Å—Ç—Ä–∞–Ω–∏—Ü –∏—Å–ø–æ–ª—å–∑—É–µ–º —É–ø—Ä–æ—â–µ–Ω–Ω—É—é –ø–∞–≥–∏–Ω–∞—Ü–∏—é
  if (state.totalPages > 100) {
    renderSimplifiedPagination();
  } else {
    renderStandardPagination();
  }
}

/**
 * Render simplified pagination for large page counts
 */
function renderSimplifiedPagination() {
  const html = `
        <div class="pagination-wrapper simplified">
            <div class="pagination-info">
                ${createPaginationInfo()}
            </div>
            <div class="pagination-controls simplified">
                <button class="pagination-btn" onclick="goToFirstPage()" ${
                  state.currentPage === 1 ? "disabled" : ""
                }>
                    –ü–µ—Ä–≤–∞—è
                </button>
                <button class="pagination-btn" onclick="goToPreviousPage()" ${
                  state.currentPage === 1 ? "disabled" : ""
                }>
                    ‚Üê –ù–∞–∑–∞–¥
                </button>
                
                <div class="page-input-group">
                    <span>–°—Ç—Ä–∞–Ω–∏—Ü–∞</span>
                    <input type="number" id="current-page-input" value="${
                      state.currentPage
                    }" min="1" max="${state.totalPages}">
                    <span>–∏–∑ ${state.totalPages}</span>
                    <button class="btn btn-small" onclick="jumpToPageFromInput()">–ü–µ—Ä–µ–π—Ç–∏</button>
                </div>
                
                <button class="pagination-btn" onclick="goToNextPage()" ${
                  state.currentPage === state.totalPages ? "disabled" : ""
                }>
                    –í–ø–µ—Ä–µ–¥ ‚Üí
                </button>
                <button class="pagination-btn" onclick="goToLastPage()" ${
                  state.currentPage === state.totalPages ? "disabled" : ""
                }>
                    –ü–æ—Å–ª–µ–¥–Ω—è—è
                </button>
            </div>
        </div>
    `;

  elements.paginationContainer.innerHTML = html;

  // –î–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è –ø–æ–ª—è –≤–≤–æ–¥–∞
  const pageInput = document.getElementById("current-page-input");
  if (pageInput) {
    pageInput.addEventListener("keypress", (e) => {
      if (e.key === "Enter") {
        jumpToPageFromInput();
      }
    });
  }
}

/**
 * Jump to page from current page input
 */
window.jumpToPageFromInput = function () {
  const input = document.getElementById("current-page-input");
  if (!input) return;

  const pageNumber = parseInt(input.value);

  if (isValidPage(pageNumber)) {
    goToPage(pageNumber);
  } else {
    showNotification("–ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π –Ω–æ–º–µ—Ä —Å—Ç—Ä–∞–Ω–∏—Ü—ã", "error");
    input.value = state.currentPage;
  }
};
```

### –ê–Ω–∞–ª–∏—Ç–∏–∫–∞ –ø–∞–≥–∏–Ω–∞—Ü–∏–∏

```javascript
/**
 * Track pagination usage analytics
 */
function trackPageNavigation(pageNumber) {
  trackEvent("page_navigation", {
    from_page: state.currentPage,
    to_page: pageNumber,
    total_pages: state.totalPages,
    items_per_page: state.itemsPerPage,
    has_filters: filterState.hasActiveFilters(),
  });
}

/**
 * Track pagination patterns
 */
function trackPaginationPatterns() {
  // –û—Ç—Å–ª–µ–∂–∏–≤–∞–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ä–∞–∑–Ω—ã—Ö —Å–ø–æ—Å–æ–±–æ–≤ –Ω–∞–≤–∏–≥–∞—Ü–∏–∏
  const paginationContainer = elements.paginationContainer;
  if (!paginationContainer) return;

  paginationContainer.addEventListener("click", (e) => {
    const button = e.target.closest(".pagination-btn");
    if (!button) return;

    const action = button.dataset.action;
    const page = button.dataset.page;

    let navigationType;
    if (action === "first" || action === "last") {
      navigationType = "edge_navigation";
    } else if (action === "prev" || action === "next") {
      navigationType = "sequential_navigation";
    } else if (page) {
      navigationType = "direct_navigation";
    }

    if (navigationType) {
      trackEvent("pagination_interaction", {
        type: navigationType,
        current_page: state.currentPage,
        target_page: page ? parseInt(page) : null,
        total_pages: state.totalPages,
      });
    }
  });
}
```

---

_[‚Üê –ù–∞–∑–∞–¥ –∫ –§–∏–ª—å—Ç—Ä–∞–º](12_CATALOG_FILTERS.md) | [–ö —Å–ø–∏—Å–∫—É —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤ ‚Üí](../GUIDES/)_
