<!DOCTYPE html>
<html lang="ru">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>–¢–µ—Å—Ç –ø–æ–ª–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏</title>
    <link rel="stylesheet" href="../style/style.css" />
    <style>
      .test-section {
        background: white;
        padding: 20px;
        margin: 20px 0;
        border-radius: 8px;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
      }
      .test-section h2 {
        color: #27ae60;
        margin-top: 0;
      }
      .test-buttons {
        display: flex;
        gap: 10px;
        flex-wrap: wrap;
      }
      .test-btn {
        padding: 10px 15px;
        background: #3498db;
        color: white;
        border: none;
        border-radius: 5px;
        cursor: pointer;
        font-size: 14px;
      }
      .test-btn:hover {
        background: #2980b9;
      }
      .test-result {
        margin-top: 15px;
        padding: 10px;
        border-radius: 5px;
        font-family: monospace;
        font-size: 12px;
        background: #f8f9fa;
        border: 1px solid #dee2e6;
        white-space: pre-wrap;
        max-height: 200px;
        overflow-y: auto;
      }
      .success {
        background: #d4edda;
        color: #155724;
      }
      .error {
        background: #f8d7da;
        color: #721c24;
      }
      .info {
        background: #cce7ff;
        color: #004085;
      }
    </style>
  </head>
  <body>
    <header>
      <img
        src="../img/logo.png"
        alt="–õ–æ–≥–æ—Ç–∏–ø –º–∞–≥–∞–∑–∏–Ω–∞"
        class="logo"
        width="140"
        height="70"
      />
      <nav>
        <ul class="menu" id="main-menu">
          <li><a href="../index.html">–ì–ª–∞–≤–Ω–∞—è</a></li>
          <li><a href="book.html">–ö–∞—Ç–∞–ª–æ–≥</a></li>
          <li><a href="contacts.html">–ö–æ–Ω—Ç–∞–∫—Ç—ã</a></li>
          <li><a href="register.html" id="register-link">–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</a></li>
          <li><a href="login.html" id="login-link">–í—Ö–æ–¥</a></li>
          <!-- –ë—É–¥–µ—Ç –∑–∞–º–µ–Ω–µ–Ω–æ –Ω–∞ –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏ –≤—ã—Ö–æ–¥ –ø—Ä–∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ -->
          <li>
            <a href="cart.html" class="cart-icon" id="cart-link">
              <span class="cart-icon-text">–ö–æ—Ä–∑–∏–Ω–∞</span>
              <span class="cart-count hidden" id="cart-count">0</span>
            </a>
          </li>
        </ul>
      </nav>
    </header>

    <main class="container">
      <h1>üß™ –¢–µ—Å—Ç –ø–æ–ª–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏ —Å–∏—Å—Ç–µ–º—ã</h1>

      <!-- –¢–µ—Å—Ç –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ -->
      <div class="test-section">
        <h2>üîê –¢–µ—Å—Ç —Å–∏—Å—Ç–µ–º—ã –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏</h2>
        <div class="test-buttons">
          <button class="test-btn" onclick="testAuthStatus()">
            –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
          </button>
          <button class="test-btn" onclick="testTokenValidation()">
            –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ç–æ–∫–µ–Ω
          </button>
          <button class="test-btn" onclick="testNavigationUpdate()">
            –û–±–Ω–æ–≤–∏—Ç—å –Ω–∞–≤–∏–≥–∞—Ü–∏—é
          </button>
          <button class="test-btn" onclick="simulateLogout()">
            –°–∏–º—É–ª—è—Ü–∏—è –≤—ã—Ö–æ–¥–∞
          </button>
        </div>
        <div id="auth-test-result" class="test-result"></div>
      </div>

      <!-- –¢–µ—Å—Ç –∫–æ—Ä–∑–∏–Ω—ã -->
      <div class="test-section">
        <h2>üõí –¢–µ—Å—Ç —Ñ—É–Ω–∫—Ü–∏–π –∫–æ—Ä–∑–∏–Ω—ã</h2>
        <div class="test-buttons">
          <button class="test-btn" onclick="testCartAPI()">API –∫–æ—Ä–∑–∏–Ω—ã</button>
          <button class="test-btn" onclick="testAddToCart()">
            –î–æ–±–∞–≤–∏—Ç—å –∫–Ω–∏–≥—É
          </button>
          <button class="test-btn" onclick="testCartIcon()">
            –ò–∫–æ–Ω–∫–∞ –∫–æ—Ä–∑–∏–Ω—ã
          </button>
          <button class="test-btn" onclick="testCartCount()">
            –°—á–µ—Ç—á–∏–∫ –∫–æ—Ä–∑–∏–Ω—ã
          </button>
        </div>
        <div id="cart-test-result" class="test-result"></div>
      </div>

      <!-- –¢–µ—Å—Ç API -->
      <div class="test-section">
        <h2>üåê –¢–µ—Å—Ç API –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è</h2>
        <div class="test-buttons">
          <button class="test-btn" onclick="testBooksAPI()">
            –ó–∞–≥—Ä—É–∑–∫–∞ –∫–Ω–∏–≥
          </button>
          <button class="test-btn" onclick="testCategoriesAPI()">
            –ö–∞—Ç–µ–≥–æ—Ä–∏–∏
          </button>
          <button class="test-btn" onclick="testAuthAPI()">
            –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è API
          </button>
          <button class="test-btn" onclick="testServerStatus()">
            –°—Ç–∞—Ç—É—Å —Å–µ—Ä–≤–µ—Ä–∞
          </button>
        </div>
        <div id="api-test-result" class="test-result"></div>
      </div>

      <!-- –¢–µ—Å—Ç –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ -->
      <div class="test-section">
        <h2>üé® –¢–µ—Å—Ç –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞</h2>
        <div class="test-buttons">
          <button class="test-btn" onclick="testResponsiveness()">
            –ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å
          </button>
          <button class="test-btn" onclick="testStyles()">CSS —Å—Ç–∏–ª–∏</button>
          <button class="test-btn" onclick="testModalWindows()">
            –ú–æ–¥–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞
          </button>
          <button class="test-btn" onclick="testNotifications()">
            –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
          </button>
        </div>
        <div id="ui-test-result" class="test-result"></div>
      </div>

      <!-- –û–±—â–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è -->
      <div class="test-section">
        <h2>‚ÑπÔ∏è –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Å–∏—Å—Ç–µ–º–µ</h2>
        <div class="test-buttons">
          <button class="test-btn" onclick="showSystemInfo()">
            –°–∏—Å—Ç–µ–º–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è
          </button>
          <button class="test-btn" onclick="showLocalStorageInfo()">
            LocalStorage
          </button>
          <button class="test-btn" onclick="showEnvironmentInfo()">
            –û–∫—Ä—É–∂–µ–Ω–∏–µ
          </button>
          <button class="test-btn" onclick="clearAllData()">
            –û—á–∏—Å—Ç–∏—Ç—å –¥–∞–Ω–Ω—ã–µ
          </button>
        </div>
        <div id="info-result" class="test-result"></div>
      </div>
    </main>

    <script src="../scripts/auth-utils.js"></script>
    <script>
      // –§—É–Ω–∫—Ü–∏–∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
      function testAuthStatus() {
        const result = document.getElementById("auth-test-result");
        try {
          const isAuth = Auth.isAuthenticated();
          const user = Auth.getCurrentUser();
          const token = AuthToken.get();

          result.innerHTML = `
–°—Ç–∞—Ç—É—Å –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏: ${isAuth ? "‚úÖ –ê–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω" : "‚ùå –ù–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω"}
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: ${user ? JSON.stringify(user, null, 2) : "–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö"}
–¢–æ–∫–µ–Ω: ${token ? "‚úÖ –ü—Ä–∏—Å—É—Ç—Å—Ç–≤—É–µ—Ç" : "‚ùå –û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç"}
–î–ª–∏–Ω–∞ —Ç–æ–∫–µ–Ω–∞: ${token ? token.length : 0}
                `;
          result.className = "test-result " + (isAuth ? "success" : "info");
        } catch (error) {
          result.innerHTML = `–û—à–∏–±–∫–∞: ${error.message}`;
          result.className = "test-result error";
        }
      }

      function testTokenValidation() {
        const result = document.getElementById("auth-test-result");
        try {
          const token = AuthToken.get();
          if (!token) {
            result.innerHTML = "–¢–æ–∫–µ–Ω –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç";
            result.className = "test-result info";
            return;
          }

          const payload = AuthToken.decode(token);
          result.innerHTML = `
–î–µ–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ç–æ–∫–µ–Ω:
${JSON.stringify(payload, null, 2)}

–°—Ä–æ–∫ –¥–µ–π—Å—Ç–≤–∏—è: ${
            payload.exp
              ? new Date(payload.exp * 1000).toLocaleString()
              : "–ù–µ —É–∫–∞–∑–∞–Ω"
          }
–î–µ–π—Å—Ç–≤–∏—Ç–µ–ª–µ–Ω: ${AuthToken.isValid(token) ? "‚úÖ –î–∞" : "‚ùå –ù–µ—Ç"}
                `;
          result.className = "test-result success";
        } catch (error) {
          result.innerHTML = `–û—à–∏–±–∫–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ —Ç–æ–∫–µ–Ω–∞: ${error.message}`;
          result.className = "test-result error";
        }
      }

      function testNavigationUpdate() {
        const result = document.getElementById("auth-test-result");
        try {
          Auth.updateNavigation();
          result.innerHTML = "–ù–∞–≤–∏–≥–∞—Ü–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∞ ‚úÖ";
          result.className = "test-result success";
        } catch (error) {
          result.innerHTML = `–û—à–∏–±–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –Ω–∞–≤–∏–≥–∞—Ü–∏–∏: ${error.message}`;
          result.className = "test-result error";
        }
      }

      function simulateLogout() {
        const result = document.getElementById("auth-test-result");
        try {
          Auth.logout();
          result.innerHTML =
            "–í—ã—Ö–æ–¥ –≤—ã–ø–æ–ª–Ω–µ–Ω ‚úÖ\n–ù–∞–≤–∏–≥–∞—Ü–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∞\n–î–∞–Ω–Ω—ã–µ –æ—á–∏—â–µ–Ω—ã";
          result.className = "test-result success";
        } catch (error) {
          result.innerHTML = `–û—à–∏–±–∫–∞ –ø—Ä–∏ –≤—ã—Ö–æ–¥–µ: ${error.message}`;
          result.className = "test-result error";
        }
      }

      // –§—É–Ω–∫—Ü–∏–∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∫–æ—Ä–∑–∏–Ω—ã
      async function testCartAPI() {
        const result = document.getElementById("cart-test-result");
        try {
          const token = AuthToken.get();
          if (!token) {
            result.innerHTML = "–¢—Ä–µ–±—É–µ—Ç—Å—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∫–æ—Ä–∑–∏–Ω—ã";
            result.className = "test-result info";
            return;
          }

          const response = await fetch("/api/cart", {
            headers: {
              Authorization: `Bearer ${token}`,
            },
          });

          if (response.ok) {
            const cartData = await response.json();
            result.innerHTML = `
API –∫–æ—Ä–∑–∏–Ω—ã –¥–æ—Å—Ç—É–ø–Ω–æ ‚úÖ
–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç–æ–≤–∞—Ä–æ–≤: ${cartData.items ? cartData.items.length : 0}
–î–∞–Ω–Ω—ã–µ –∫–æ—Ä–∑–∏–Ω—ã:
${JSON.stringify(cartData, null, 2)}
                    `;
            result.className = "test-result success";
          } else {
            result.innerHTML = `–û—à–∏–±–∫–∞ API: ${response.status} ${response.statusText}`;
            result.className = "test-result error";
          }
        } catch (error) {
          result.innerHTML = `–û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ API –∫–æ—Ä–∑–∏–Ω—ã: ${error.message}`;
          result.className = "test-result error";
        }
      }

      async function testAddToCart() {
        const result = document.getElementById("cart-test-result");
        try {
          if (!Auth.isAuthenticated()) {
            result.innerHTML = "–¢—Ä–µ–±—É–µ—Ç—Å—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –≤ –∫–æ—Ä–∑–∏–Ω—É";
            result.className = "test-result info";
            return;
          }

          const response = await fetch("/api/cart", {
            method: "POST",
            headers: {
              "Content-Type": "application/json",
              Authorization: `Bearer ${AuthToken.get()}`,
            },
            body: JSON.stringify({
              bookId: 1,
              quantity: 1,
            }),
          });

          if (response.ok) {
            result.innerHTML = "–¢–µ—Å—Ç–æ–≤–∞—è –∫–Ω–∏–≥–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∞ –≤ –∫–æ—Ä–∑–∏–Ω—É ‚úÖ";
            result.className = "test-result success";
            Auth.updateCartCount(); // –û–±–Ω–æ–≤–ª—è–µ–º —Å—á–µ—Ç—á–∏–∫
          } else {
            const errorData = await response.json();
            result.innerHTML = `–û—à–∏–±–∫–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è: ${
              errorData.message || response.statusText
            }`;
            result.className = "test-result error";
          }
        } catch (error) {
          result.innerHTML = `–û—à–∏–±–∫–∞: ${error.message}`;
          result.className = "test-result error";
        }
      }

      function testCartIcon() {
        const result = document.getElementById("cart-test-result");
        try {
          Auth.updateCartIcon();
          const cartIcon = document.getElementById("cart-link");
          const cartCount = document.getElementById("cart-count");

          result.innerHTML = `
–ò–∫–æ–Ω–∫–∞ –∫–æ—Ä–∑–∏–Ω—ã –æ–±–Ω–æ–≤–ª–µ–Ω–∞ ‚úÖ
–≠–ª–µ–º–µ–Ω—Ç –Ω–∞–π–¥–µ–Ω: ${cartIcon ? "‚úÖ" : "‚ùå"}
–°—á–µ—Ç—á–∏–∫ –Ω–∞–π–¥–µ–Ω: ${cartCount ? "‚úÖ" : "‚ùå"}
–ö–ª–∞—Å—Å —Å—á–µ—Ç—á–∏–∫–∞: ${cartCount ? cartCount.className : "–≠–ª–µ–º–µ–Ω—Ç –Ω–µ –Ω–∞–π–¥–µ–Ω"}
                `;
          result.className = "test-result success";
        } catch (error) {
          result.innerHTML = `–û—à–∏–±–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∏–∫–æ–Ω–∫–∏: ${error.message}`;
          result.className = "test-result error";
        }
      }

      async function testCartCount() {
        const result = document.getElementById("cart-test-result");
        try {
          await Auth.updateCartCount();
          const cartCount = document.getElementById("cart-count");

          result.innerHTML = `
–°—á–µ—Ç—á–∏–∫ –∫–æ—Ä–∑–∏–Ω—ã –æ–±–Ω–æ–≤–ª–µ–Ω ‚úÖ
–¢–µ–∫—É—â–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ: ${cartCount ? cartCount.textContent : "–≠–ª–µ–º–µ–Ω—Ç –Ω–µ –Ω–∞–π–¥–µ–Ω"}
–í–∏–¥–∏–º–æ—Å—Ç—å: ${
            cartCount && !cartCount.classList.contains("hidden")
              ? "–í–∏–¥–∏–º—ã–π"
              : "–°–∫—Ä—ã—Ç—ã–π"
          }
                `;
          result.className = "test-result success";
        } catch (error) {
          result.innerHTML = `–û—à–∏–±–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å—á–µ—Ç—á–∏–∫–∞: ${error.message}`;
          result.className = "test-result error";
        }
      }

      // –§—É–Ω–∫—Ü–∏–∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è API
      async function testBooksAPI() {
        const result = document.getElementById("api-test-result");
        try {
          const response = await fetch("/api/books?limit=5");
          if (response.ok) {
            const data = await response.json();
            result.innerHTML = `
API –∫–Ω–∏–≥ —Ä–∞–±–æ—Ç–∞–µ—Ç ‚úÖ
–ü–æ–ª—É—á–µ–Ω–æ –∫–Ω–∏–≥: ${data.books ? data.books.length : 0}
–û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ: ${data.total || "–ù–µ —É–∫–∞–∑–∞–Ω–æ"}
                    `;
            result.className = "test-result success";
          } else {
            result.innerHTML = `–û—à–∏–±–∫–∞ API –∫–Ω–∏–≥: ${response.status} ${response.statusText}`;
            result.className = "test-result error";
          }
        } catch (error) {
          result.innerHTML = `–û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ API –∫–Ω–∏–≥: ${error.message}`;
          result.className = "test-result error";
        }
      }

      async function testCategoriesAPI() {
        const result = document.getElementById("api-test-result");
        try {
          const response = await fetch("/api/categories");
          if (response.ok) {
            const categories = await response.json();
            result.innerHTML = `
API –∫–∞—Ç–µ–≥–æ—Ä–∏–π —Ä–∞–±–æ—Ç–∞–µ—Ç ‚úÖ
–ü–æ–ª—É—á–µ–Ω–æ –∫–∞—Ç–µ–≥–æ—Ä–∏–π: ${categories.length}
–ö–∞—Ç–µ–≥–æ—Ä–∏–∏: ${categories.map((c) => c.name).join(", ")}
                    `;
            result.className = "test-result success";
          } else {
            result.innerHTML = `–û—à–∏–±–∫–∞ API –∫–∞—Ç–µ–≥–æ—Ä–∏–π: ${response.status} ${response.statusText}`;
            result.className = "test-result error";
          }
        } catch (error) {
          result.innerHTML = `–û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ API –∫–∞—Ç–µ–≥–æ—Ä–∏–π: ${error.message}`;
          result.className = "test-result error";
        }
      }

      async function testAuthAPI() {
        const result = document.getElementById("api-test-result");
        try {
          const response = await fetch("/api/auth/verify", {
            headers: {
              Authorization: `Bearer ${AuthToken.get() || "invalid-token"}`,
            },
          });

          result.innerHTML = `
API –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –æ—Ç–≤–µ—á–∞–µ—Ç ‚úÖ
–°—Ç–∞—Ç—É—Å: ${response.status}
–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è: ${response.ok ? "–í–∞–ª–∏–¥–Ω–∞" : "–ù–µ–≤–∞–ª–∏–¥–Ω–∞"}
                `;
          result.className =
            "test-result " + (response.ok ? "success" : "info");
        } catch (error) {
          result.innerHTML = `–û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ API –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏: ${error.message}`;
          result.className = "test-result error";
        }
      }

      async function testServerStatus() {
        const result = document.getElementById("api-test-result");
        try {
          const startTime = Date.now();
          const response = await fetch("/api/books?limit=1");
          const endTime = Date.now();

          result.innerHTML = `
–°–µ—Ä–≤–µ—Ä –¥–æ—Å—Ç—É–ø–µ–Ω ‚úÖ
–í—Ä–µ–º—è –æ—Ç–≤–µ—Ç–∞: ${endTime - startTime}–º—Å
–°—Ç–∞—Ç—É—Å: ${response.status}
                `;
          result.className = "test-result success";
        } catch (error) {
          result.innerHTML = `–°–µ—Ä–≤–µ—Ä –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω ‚ùå\n–û—à–∏–±–∫–∞: ${error.message}`;
          result.className = "test-result error";
        }
      }

      // –§—É–Ω–∫—Ü–∏–∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
      function testResponsiveness() {
        const result = document.getElementById("ui-test-result");
        const width = window.innerWidth;
        const height = window.innerHeight;

        let deviceType = "Desktop";
        if (width <= 480) deviceType = "Mobile";
        else if (width <= 768) deviceType = "Tablet";

        result.innerHTML = `
–†–∞–∑–º–µ—Ä –æ–∫–Ω–∞: ${width}x${height}
–¢–∏–ø —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞: ${deviceType}
Viewport meta: ${document.querySelector('meta[name="viewport"]') ? "‚úÖ" : "‚ùå"}
CSS Grid –ø–æ–¥–¥–µ—Ä–∂–∫–∞: ${CSS.supports("display", "grid") ? "‚úÖ" : "‚ùå"}
CSS Flexbox –ø–æ–¥–¥–µ—Ä–∂–∫–∞: ${CSS.supports("display", "flex") ? "‚úÖ" : "‚ùå"}
            `;
        result.className = "test-result success";
      }

      function testStyles() {
        const result = document.getElementById("ui-test-result");
        const stylesheets = Array.from(document.styleSheets);
        const cartIcon = document.querySelector(".cart-icon");

        result.innerHTML = `
–ó–∞–≥—Ä—É–∂–µ–Ω–æ —Å—Ç–∏–ª–µ–π: ${stylesheets.length}
–ò–∫–æ–Ω–∫–∞ –∫–æ—Ä–∑–∏–Ω—ã: ${cartIcon ? "‚úÖ –ù–∞–π–¥–µ–Ω–∞" : "‚ùå –ù–µ –Ω–∞–π–¥–µ–Ω–∞"}
–°—Ç–∏–ª–∏ –∫–æ—Ä–∑–∏–Ω—ã: ${getComputedStyle(cartIcon || document.body).getPropertyValue(
          "background-color"
        )}
            `;
        result.className = "test-result success";
      }

      function testModalWindows() {
        const result = document.getElementById("ui-test-result");
        result.innerHTML = "–§—É–Ω–∫—Ü–∏—è –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ...";
        result.className = "test-result info";
      }

      function testNotifications() {
        const result = document.getElementById("ui-test-result");

        // –°–æ–∑–¥–∞–µ–º —Ç–µ—Å—Ç–æ–≤–æ–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
        const notification = document.createElement("div");
        notification.className = "notification success show";
        notification.textContent = "–¢–µ—Å—Ç–æ–≤–æ–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ ‚úÖ";
        notification.style.position = "fixed";
        notification.style.top = "20px";
        notification.style.right = "20px";
        notification.style.zIndex = "1000";

        document.body.appendChild(notification);

        setTimeout(() => {
          document.body.removeChild(notification);
        }, 3000);

        result.innerHTML =
          "–¢–µ—Å—Ç–æ–≤–æ–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –ø–æ–∫–∞–∑–∞–Ω–æ ‚úÖ\n–ë—É–¥–µ—Ç —É–¥–∞–ª–µ–Ω–æ —á–µ—Ä–µ–∑ 3 —Å–µ–∫—É–Ω–¥—ã";
        result.className = "test-result success";
      }

      // –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
      function showSystemInfo() {
        const result = document.getElementById("info-result");
        result.innerHTML = `
–ë—Ä–∞—É–∑–µ—Ä: ${navigator.userAgent}
–Ø–∑—ã–∫: ${navigator.language}
–ü–ª–∞—Ç—Ñ–æ—Ä–º–∞: ${navigator.platform}
Cookies –≤–∫–ª—é—á–µ–Ω—ã: ${navigator.cookieEnabled ? "‚úÖ" : "‚ùå"}
Online: ${navigator.onLine ? "‚úÖ" : "‚ùå"}
LocalStorage –ø–æ–¥–¥–µ—Ä–∂–∫–∞: ${typeof Storage !== "undefined" ? "‚úÖ" : "‚ùå"}
            `;
        result.className = "test-result info";
      }

      function showLocalStorageInfo() {
        const result = document.getElementById("info-result");
        const items = [];
        for (let i = 0; i < localStorage.length; i++) {
          const key = localStorage.key(i);
          const value = localStorage.getItem(key);
          items.push(
            `${key}: ${value.substring(0, 100)}${
              value.length > 100 ? "..." : ""
            }`
          );
        }

        result.innerHTML = `
–≠–ª–µ–º–µ–Ω—Ç–æ–≤ –≤ LocalStorage: ${localStorage.length}
–î–∞–Ω–Ω—ã–µ:
${items.join("\n")}
            `;
        result.className = "test-result info";
      }

      function showEnvironmentInfo() {
        const result = document.getElementById("info-result");
        result.innerHTML = `
URL: ${window.location.href}
Protocol: ${window.location.protocol}
Host: ${window.location.host}
Pathname: ${window.location.pathname}
Auth —É—Ç–∏–ª–∏—Ç—ã –∑–∞–≥—Ä—É–∂–µ–Ω—ã: ${typeof Auth !== "undefined" ? "‚úÖ" : "‚ùå"}
AuthToken —É—Ç–∏–ª–∏—Ç—ã –∑–∞–≥—Ä—É–∂–µ–Ω—ã: ${typeof AuthToken !== "undefined" ? "‚úÖ" : "‚ùå"}
            `;
        result.className = "test-result info";
      }

      function clearAllData() {
        const result = document.getElementById("info-result");
        localStorage.clear();
        sessionStorage.clear();
        result.innerHTML =
          "–í—Å–µ –¥–∞–Ω–Ω—ã–µ –æ—á–∏—â–µ–Ω—ã ‚úÖ\nLocalStorage –∏ SessionStorage –æ—á–∏—â–µ–Ω—ã";
        result.className = "test-result success";

        // –û–±–Ω–æ–≤–ª—è–µ–º –Ω–∞–≤–∏–≥–∞—Ü–∏—é –ø–æ—Å–ª–µ –æ—á–∏—Å—Ç–∫–∏
        setTimeout(() => {
          Auth.updateNavigation();
        }, 500);
      }

      // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
      document.addEventListener("DOMContentLoaded", function () {
        // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±–Ω–æ–≤–ª—è–µ–º –Ω–∞–≤–∏–≥–∞—Ü–∏—é
        if (typeof Auth !== "undefined") {
          Auth.updateNavigation();
          Auth.updateCartIcon();
          Auth.updateCartCount();
        }

        console.log("üß™ –°—Ç—Ä–∞–Ω–∏—Ü–∞ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∑–∞–≥—Ä—É–∂–µ–Ω–∞");
        console.log("–î–æ—Å—Ç—É–ø–Ω—ã–µ —Ç–µ—Å—Ç—ã:", {
          auth: typeof Auth !== "undefined",
          authToken: typeof AuthToken !== "undefined",
        });
      });
    </script>
  </body>
</html>
